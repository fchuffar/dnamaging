---
title: "Descriptive Statistics"
author: "Fabien Jossaud, Florent Chuffart"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
---


```{r include=FALSE}
knitr::opts_chunk$set(collapse=TRUE, comment = "#>", fig.width=9, fig.height=6, eval=TRUE, echo=TRUE, results="verbatim")
```

```{r data}

if (!exists("mreadRDS")) { mreadRDS = memoise::memoise(readRDS) }
if (!exists("df_GSE40279")) {
  df_GSE40279 = mreadRDS("df_GSE40279.rds")  
}
df = df_GSE40279

# Index

idx_samples = rownames(df)
idx_clinicals = colnames(df)[1:7]
idx_cpg = colnames(df)[8:ncol(df)]


```

```{r Age distribution}

par(mfrow = c(1,1))
AgeD = hist(df$age__y_, breaks=20, col="red",prob =TRUE, ylim = c(0,0.035)) 
DA = density(df$age__y_)
lines(DA$x,DA$y)
Norm_Age = shapiro.test(df$age__y_)
text(60,0.03, paste0("SW Normality test p-val = ", round(Norm_Age$p.value,5)))


```

```{r Gender}

idx_g = colnames(df)[5]

dist_g = table(df$gender)  
bar_g = barplot(dist_g,col = c("pink","blue"), ylim = c(0,nrow(df)*0.7))
text(bar_g, dist_g + nrow(df)*0.02, labels = dist_g)

AfG = aggregate(age__y_~gender,data=df,mean)
bar_AfG = barplot(height = AfG$age__y_ , names = AfG$gender, col=c("pink","blue"), ylim = c(0,100))
text(bar_AfG, AfG$age__y_ + 2, labels = AfG$age__y_)
Age_H = df$age__y_[which(df$gender == "M")]
Age_F = df$age__y_[which(df$gender == "F")]
WTG = wilcox.test(Age_F,Age_H)
text(x = 1, y = 80, labels = paste0("Wilcoxon p-val =", WTG$p.value))

beanplot::beanplot(age__y_~gender,data=df,col = c("blue","red"),method="jitter")
text(x = 1.5, y = 110, labels = paste0("Wilcoxon p-val =", WTG$p.value))

boxplot(age__y_~gender,data=df)
text(x = 1.5, y = 90, labels = paste0("Wilcoxon p-val =", WTG$p.value))
abline(h = mean(df$age__y_), col ="red")
abline(h = mean(Age_H), col ="green") # Error boxplot for mean ?
abline(h = mean(Age_F), col ="blue")

# First style 

par(mfrow = c(1,2))

hist(Age_H, breaks=20, col = "blue", prob = TRUE)
DAH = density(Age_H)
lines(DAH$x, DAH$y)

hist(Age_F, breaks=20, col = "pink", prob = TRUE)
DAF = density(Age_F)
lines(DAF$x, DAF$y) 

# Other style 

hist(Age_H, breaks=20, col = "blue", prob = TRUE)
DAH = density(Age_H)
lines(DAH$x, DAH$y, col = "blue", lwd = 3)

par(new = TRUE) 

hist(Age_F, breaks=20, col = "pink", prob = TRUE)
DAF = density(Age_F)
lines(DAF$x, DAF$y, col = "pink", lwd = 3) 

```
# Session Information

```{r, results="verbatim"}
sessionInfo()
```

